<!DOCTYPE html>
<html>

<head>

  <title>Realtime Communication Demo</title>
  <link rel="stylesheet" href="css/main.css" />

  <style>
    dialog {
      background: #e8e8e8;
      border: 1px solid #dadada;
      font-family: sans-serif;
      padding: 10px 20px;
      margin-top: 100px;
    }
    
    #localVideo {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 200px;
      background-color: rgb(102, 51, 153);
    }
  </style>
</head>

<body>

  <dialog id="popupDialog">
    <h3>Input room and user name!</h3>
    <p id="roomLabel">Enter room name:</p>
    <input type="text" style="width: 250px; height: 30px; padding: 5px" id="roomName" value="test" />
    <p id="userLabel">Enter user name:</p>
    <input type="text" style="width: 250px; height: 30px; padding: 5px" id="userName" value="test" />
    <br/>
    <button id="connectBtn" style="margin-left: 100px;margin-top: 20px;width: 100px;height: 30px;" autofocus>Connect</button>
  </dialog>

  <div id="chatScreen" style="display: none; padding: 5px; text-align: center">
    <!--<div style="display: inline-block; width: 500px">
      <div id="displayMsg" style="overflow-y:scroll; height:305px; background-color: #FFEBCD; color: blue">
      </div>
      <div style="margin-top: 5px">
        <textarea id="inputMsg" style="width: 325px;height: 50px;resize: none" placeholder="Enter some text..."></textarea>
        <button id="videoCall" style="background-color:#00FF3A; height: 55px; width:50px; float:right; margin-left: 5px">Video Call</button>
        <button id="sendFile" style="background-color:#00CCD0; height: 55px; width:50px; float:right; margin-left: 5px">Send File</button>
        <button id="sendMsg" style="background-color:#DADADA; height: 55px; width:50px; float:right">Send Text</button>
      </div>
      <br/>
    </div>
    <div id="videoDisplay" style="display: inline-block; position: absolute">
    </div>-->
    <video id="localVideo" poster="http://2.bp.blogspot.com/-V31y2Ef4Ad0/VZservQf70I/AAAAAAAAdu8/ErI--hbXwfE/s1600/OpenCamera1.png" autoplay>
    </video>
    <video id="remoteVideo" poster="http://2.bp.blogspot.com/-V31y2Ef4Ad0/VZservQf70I/AAAAAAAAdu8/ErI--hbXwfE/s1600/OpenCamera1.png" autoplay>
    </video>
    <br/>
    <button id="stopCall" style="background-color: rgb(255, 15, 0);height: 50px;width: 200px;color: white;font-stretch: bold;font-weight: bold;">Stop Call</button>
  </div>

  <script src="js/lib/adapter.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script src="js/chatroom.js"></script>
  <script src="js/signaling.js"></script>
  <script src="js/main.js"></script>

  <script type="text/javascript">
    // createSignallingConnection
	  // trace('Created signaling connection');
    // createSignalingConnection();
    
    // create room
    var chatScreen = document.getElementById('chatScreen');  
    var dialog = document.getElementById('popupDialog');  
    var roomInput = document.getElementById('roomName');
    var userInput = document.getElementById('userName');
    var roomLabel = document.getElementById('roomLabel');
    var userLabel = document.getElementById('userLabel');  
    
    document.getElementById('connectBtn').onclick = function() {
        if (roomInput.value != "" && userInput.value != "") {
          startVideoCall(roomInput.value, userInput.value, function (message, error) {
             if(error) {
               alert(error);
               dialog.show();
             } else { 
               chatScreen.style.display = "block";
               dialog.close();
             }
          });
        } else {
          if(roomInput.value == "") {
            roomLabel.style.color = "red";
          } else {
            roomLabel.style.color = "black";
          }
          if(userInput.value == "") {
            userLabel.style.color = "red";
          } else {
            userLabel.style.color = "black";
          }
        }
    };
    
    dialog.show();
  </script>

</body>

</html>